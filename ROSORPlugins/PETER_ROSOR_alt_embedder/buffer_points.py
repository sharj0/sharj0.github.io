import matplotlib.pyplot as plt
from shapely.geometry import Point, MultiPolygon, Polygon
from shapely.ops import unary_union
import numpy as np
from matplotlib.widgets import Button
import time
from PyQt5.QtWidgets import QMessageBox, QDialog, QVBoxLayout, QLabel, QApplication

# PROFILER CHUNK 1/3 START ////////////////////////////////////////////////////////////////////////////////////
#import cProfile
#import pstats
#import io
# PROFILER CHUNK 1/3 END ////////////////////////////////////////////////////////////////////////////////////

def buffer_points_old(x_coords, y_coords, buffer):
    return [Point(x, y).buffer(buffer, resolution=4) for x, y in zip(x_coords, y_coords)]

def create_buffered_polygon(x_coords, y_coords, buffer):

    # Create points and compute buffers
    #buffered_points = buffer_points_old(x_coords, y_coords, buffer)
    buffered_points = buffer_points_new(x_coords, y_coords, buffer)
    # Combine overlapping buffers
    merged_buffer = unary_union(buffered_points)


    if isinstance(merged_buffer, (list, tuple)):
        polygons = merged_buffer
    else:
        polygons = [merged_buffer]
    if len(polygons) > 1:
        err_message = f"unexpected behaviour. increase safety buffer."
        QMessageBox.critical(None, "Error", err_message)
        raise ValueError(err_message)
    return polygons[0]


from shapely.geometry import Polygon
import numpy as np


def buffer_points_new(x_list, y_list, buffer):
    x_coords, y_coords = np.array(x_list), np.array(y_list)

    # Angles for the eight directions in radians
    angles = np.radians(np.array([0, 45, 67.5, 90, 112.5, 135, 180]))

    # Create offsets for each direction
    dx_ang = buffer * np.cos(angles)
    dy_ang  = buffer * np.sin(angles)

    dx = np.concatenate(([buffer], dx_ang, [-buffer]))
    dy = np.concatenate(([-buffer], dy_ang, [-buffer]))

    # Original coordinates expanded for broadcasting
    original_x = x_coords[:, np.newaxis]  # Shape will be (num_points, 1)
    original_y = y_coords[:, np.newaxis]  # Shape will be (num_points, 1)

    # New coordinates, shape will be (num_points, 8)
    new_x_coords = original_x + dx
    new_y_coords = original_y + dy

    polys = []
    for i in range(len(new_x_coords)):
        # Create a list of tuples for each point's buffered coordinates
        buffered_coords = list(zip(new_x_coords[i], new_y_coords[i]))
        # Ensure the polygon is closed by adding the start point to the end
        buffered_coords.append(buffered_coords[0])
        # Create a Polygon from the buffered coordinates
        poly = Polygon(buffered_coords)
        # Append the Polygon to the list
        polys.append(poly)
    return polys


def show_wait_dialog(text="Calculating buffers ..."):
    """
    Create and show a modal dialog with a "Calculating buffers ..." message.

    Returns:
        QDialog: The displayed dialog.
    """
    dialog = QDialog()
    dialog.setWindowTitle("Please wait...")
    layout = QVBoxLayout()
    label = QLabel(text)
    layout.addWidget(label)
    dialog.setLayout(layout)
    dialog.show()
    QApplication.processEvents()  # Ensure that the dialog gets painted immediately
    return dialog

def toggle_aspect(event, ax, button):
    if ax.get_aspect() == 'auto':
        ax.set_aspect('equal')
        button.label.set_text("Current aspect ratio 'real' click to set to 'flexible'")
    else:
        ax.set_aspect('auto')
        button.label.set_text("Current aspect ratio 'flexible' click to set to 'real'")
    plt.draw()


def split_linear_ring_to_linestrings(outer_buff):
    """
    Split a linear ring (represented as a 2D numpy array) into two line strings
    based on the max and min x coordinates.

    Parameters:
        outer_buff (numpy.ndarray): The linear ring represented as a 2xN numpy array.

    Returns:
        numpy.ndarray, numpy.ndarray: Two line strings of the split linear ring.
    """
    # Separate the x and y coordinates
    x_coords, y_coords = outer_buff

    # Find the indices of the min and max x coordinates
    min_x_index = np.argmin(x_coords)
    max_x_index = np.argmax(x_coords)

    # Create two line strings from the min to max and max to min (wrapping around)
    if min_x_index <= max_x_index:
        first_half_x = np.concatenate([x_coords[min_x_index:max_x_index+1], [x_coords[max_x_index]]])
        first_half_y = np.concatenate([y_coords[min_x_index:max_x_index+1], [y_coords[max_x_index]]])
        second_half_x = np.concatenate([x_coords[max_x_index:], x_coords[:min_x_index+1]])
        second_half_y = np.concatenate([y_coords[max_x_index:], y_coords[:min_x_index+1]])
    else:
        first_half_x = np.concatenate([x_coords[min_x_index:], x_coords[:max_x_index+1]])
        first_half_y = np.concatenate([y_coords[min_x_index:], y_coords[:max_x_index+1]])
        second_half_x = np.concatenate([x_coords[max_x_index:min_x_index+1], [x_coords[min_x_index]]])
        second_half_y = np.concatenate([y_coords[max_x_index:min_x_index+1], [y_coords[min_x_index]]])

    # Combine the x and y coordinates back into 2D arrays
    first_half = np.vstack([first_half_x, first_half_y])
    second_half = np.vstack([second_half_x, second_half_y])

    return first_half, second_half


def run(grnd_x, grnd_y, grnd_buffer, grnd_nodata_value,
        surf_x, surf_y, surf_buffer, surf_nodata_value,
        plot=False):
    # PROFILER CHUNK 2/3 START ////////////////////////////////////////////////////////////////////////////////////
    #pr = cProfile.Profile()
    #pr.enable()
    # PROFILER CHUNK 2/3 END ////////////////////////////////////////////////////////////////////////////////////
    bad_samples = False
    #see if we are trying to sample anywhere where there is no data:
    if np.any(grnd_y == grnd_nodata_value):
        err_message = f"Flying over areas without ground data!"
        QMessageBox.critical(None, "Error", err_message)
        plot, bad_samples = True, True
    if np.any(surf_y == surf_nodata_value):
        err_message = f"Flying over areas without surface data!"
        QMessageBox.critical(None, "Error", err_message)
        plot, bad_samples = True, True

    #dialog = show_wait_dialog("Calculating buffers ...")
    start_time = time.perf_counter()

    grnd_polygons = buffer_points_new(grnd_x, grnd_y, grnd_buffer)
    surf_polygons = buffer_points_new(surf_x, surf_y, surf_buffer)

    print(f"Elapsed time: {time.perf_counter() - start_time} seconds")
    #dialog.close()
    # split the buffer polygon into top and bottom
    if not bad_samples:
        merged_buffer = unary_union(grnd_polygons+surf_polygons)
        outer_buff = np.array(merged_buffer.exterior.xy)
        outer_buff1, outer_buff2 = split_linear_ring_to_linestrings(outer_buff)

        # determine which is the top vs bottom by taking ave y value
        mean_ys = np.array([outer_buff1[1].mean(), outer_buff2[1].mean()])
        if np.argmax(mean_ys) == 0:
            outer_buff = outer_buff1
        else:
            outer_buff = outer_buff2

    else:
        outer_buff = None
    if plot:
        grnd_polygon = unary_union(grnd_polygons)
        surf_polygon = unary_union(surf_polygons)
        plot_polygons(grnd_polygon, surf_polygon, grnd_x, grnd_y, surf_x, surf_y, outer_buff)
    if bad_samples:
        err_message = f"Need more lidar coverage or interpolation"
        msg = QMessageBox()
        msg.setIcon(QMessageBox.Information)
        msg.setText(err_message)
        msg.setWindowTitle(err_message)
        msg.exec_()

    # PROFILER CHUNK 3/3 START ////////////////////////////////////////////////////////////////////////////////////
    #pr.disable()
    #s = io.StringIO()
    #sortby = 'cumulative'  # Can be 'calls', 'time', 'cumulative', etc.
    #ps = pstats.Stats(pr, stream=s).sort_stats(sortby)
    #ps.print_stats()
    #print(s.getvalue())
    # PROFILER CHUNK 3/3  TEMP END ////////////////////////////////////////////////////////////////////////////////////

    return outer_buff

def plot_polygons(grnd_polygon, surf_polygon, grnd_x, grnd_y, surf_x, surf_y, outer_buff):
    fig, ax = plt.subplots(figsize=(10, 10))
    plt.subplots_adjust(bottom=0.2)  # make space for the button
    # Plotting ground polygon
    if isinstance(grnd_polygon, MultiPolygon):
        for poly in grnd_polygon.geoms:
            x, y = poly.exterior.xy
            ax.fill(x, y, alpha=0.3, edgecolor='brown', facecolor='brown')
    else:
        x, y = grnd_polygon.exterior.xy
        ax.fill(x, y, alpha=0.3, edgecolor='brown', facecolor='brown')
    # Plotting surface polygon
    if isinstance(surf_polygon, MultiPolygon):
        for poly in surf_polygon.geoms:
            x, y = poly.exterior.xy
            ax.fill(x, y, alpha=0.3, edgecolor='green', facecolor='green')
    else:
        x, y = surf_polygon.exterior.xy
        ax.fill(x, y, alpha=0.3, edgecolor='green', facecolor='green')
    # Plot the merged_buffer as a thin black line
    if not outer_buff is None:
        x, y = outer_buff
        ax.plot(x, y, color='black', linewidth=1)
    ax.scatter(surf_x, surf_y, color='green', s=10)  # s sets the size of the scatter points for surface
    ax.scatter(grnd_x, grnd_y, color='brown', s=10)  # s sets the size of the scatter points for ground
    ax.set_title(f'Points and their Buffers')
    ax.set_aspect('equal')
    # Create toggle button
    ax_toggle = plt.axes([0.25, 0.05, 0.5, 0.075])
    toggle_button = Button(ax_toggle, "Current aspect ratio 'real' click to set to 'flexible'")
    toggle_button.on_clicked(lambda event: toggle_aspect(event, ax, toggle_button))
    plt.show()


if __name__ == '__main__':
    surf_example_x = \
    [900.046629981134, 900.1959677907789, 900.3453056004239, 900.893564582605, 901.04290239225, 901.192240201895, 901.7404991831588, 901.8898369928039, 902.0391748024489, 902.58743378463, 902.7367715942751, 902.88610940392, 903.035447213565, 903.4343683861011, 903.5837061957461, 903.7330440053911, 903.8823818150361, 904.281302986655, 904.4306407962999, 904.5799786059449, 904.7293164155899, 905.128237588126, 905.2775753977711, 905.4269132074161, 905.576251017061, 906.1245099992423, 906.2738478088872, 906.4231856185322, 906.9714445997961, 907.1207824094411, 907.270120219086, 907.8183792012672, 907.9677170109122, 908.1170548205572, 908.2663926302123, 908.6653138027383, 908.8146516123833, 908.9639894220282, 909.1133272316833, 909.5122484032922, 909.6615862129372, 909.8109240225822, 909.9602618322373, 910.5085208144083, 910.6578586240532, 910.8071964337084, 911.3554554149623, 911.5047932246073, 911.6541310342623, 912.2023900164334, 912.3517278260783, 912.5010656357334, 913.0493246179044, 913.1986624275494, 913.3480002372045, 913.4973380468494, 913.8962592184583, 914.0455970281033, 914.1949348377584, 914.3442726474034, 914.7431938199295, 914.8925316295745, 915.0418694392295, 915.1912072488744, 915.7394662310455, 915.8888040407006, 916.0381418503456, 916.5864008315993, 916.7357386412546, 916.8850764508995, 917.4333354330705, 917.5826732427256, 917.7320110523706, 918.2802700345417, 918.4296078441967, 918.5789456538416, 918.7282834634866, 919.1272046350955, 919.2765424447507, 919.4258802543957, 919.5752180640407, 919.9741392365667, 920.1234770462218, 920.2728148558667, 920.4221526655117, 920.9704116476928, 921.1197494573378, 921.2690872669828, 921.8173462482467, 921.9666840578917, 922.1160218675367, 922.6642808497179, 922.8136186593629, 922.9629564690078, 923.1122942786528, 923.5112154502717, 923.6605532599167, 923.8098910695617, 923.9592288792066, 924.3581500517428, 924.5074878613877, 924.6568256710327, 924.8061634806777, 925.3544224628589, 925.5037602725039, 925.6530980821489, 926.2013570634128, 926.3506948730578, 926.5000326827028, 927.0482916648839, 927.1976294745289, 927.3469672841738, 927.895226266355, 928.044564076, 928.193901885645, 928.3432396953001, 928.742160866909, 928.891498676554, 929.0408364861989, 929.1901742958539, 929.58909546838, 929.738433278025, 929.88777108767, 930.0371088973251, 930.5853678794961, 930.734705689141, 930.8840434987962, 931.4323024800501, 931.5816402896951, 931.7309780993501, 932.2792370815212, 932.4285748911661, 932.5779127008212, 933.126171682075, 933.27550949172, 933.4248473013752, 933.5741851110201, 933.9731062835461, 934.1224440931911, 934.2717819028462, 934.4211197124912, 934.8200408850173, 934.9693786946623, 935.1187165043173, 935.2680543139622, 935.8163132952161, 935.9656511048713, 936.1149889145163, 936.6632478966872, 936.8125857063424, 936.9619235159873, 937.5101824981583, 937.6595203078134, 937.8088581174584, 937.9581959271034, 938.3571170987123, 938.5064549083673, 938.6557927180123, 938.8051305276573, 939.2040517001833, 939.3533895098385, 939.5027273194835, 939.6520651291285, 940.2003241113096, 940.3496619209545, 940.4989997305995, 941.0472587118634, 941.1965965215084, 941.3459343311533, 941.8941933133345, 942.0435311229795, 942.1928689326245, 942.7411279148057, 942.8904657244507, 943.0398035340957, 943.1891413437406, 943.5880625153595, 943.7374003250045, 943.8867381346495, 944.0360759442945, 944.4349971168306, 944.5843349264755, 944.7336727361205, 944.8830105457655, 945.4312695270296, 945.5806073366746, 945.7299451463196, 946.2782041285006, 946.4275419381456, 946.5768797477906, 947.1251387299717, 947.2744765396167, 947.4238143492616, 947.9720733305256, 948.1214111401706, 948.2707489498156, 948.4200867594606, 948.8190079319968, 948.9683457416418, 949.1176835512867, 949.2670213609317, 949.6659425334678, 949.8152803431128, 949.9646181527578, 950.1139559624028, 950.6622149436668, 950.8115527533117, 950.9608905629567, 951.5091495451379, 951.6584873547829, 951.8078251644279, 952.356084146609, 952.5054219562539, 952.6547597658989, 952.8040975755539, 953.2030187471628, 953.3523565568078, 953.5016943664527, 953.651032176108, 954.049953348634, 954.1992911582789, 954.3486289679239, 954.497966777579, 955.0462257588329, 955.1955635684778, 955.3449013781329, 955.8931603603039, 956.0424981699489, 956.1918359796041, 956.740094961775, 956.8894327714199, 957.0387705810751, 957.587029562329, 957.736367371974, 957.885705181629, 958.0350429912739, 958.4339641638, 958.583301973445, 958.7326397831001, 958.8819775927451, 959.2808987652711, 959.4302365749161, 959.5795743845713, 959.7289121942163, 960.27717117547, 960.4265089851251, 960.5758467947701, 961.1241057769412, 961.2734435865962, 961.4227813962411, 961.9710403784122, 962.1203781880673, 962.2697159977123, 962.8179749789662, 962.9673127886213, 963.1166505982662, 963.2659884079112, 963.6649095804373, 963.8142473900923, 963.9635851997373, 964.1129230093823, 964.5118441819084, 964.6611819915634, 964.8105198012083, 964.9598576108533, 965.5081165921174, 965.6574544017624, 965.8067922114074, 966.3550511935885, 966.5043890032334, 966.6537268128784, 967.2019857941424, 967.3513236037874, 967.5006614134323, 967.6499992230773, 968.0489203956134, 968.1982582052584, 968.3475960149034, 968.4969338245484, 968.8958549970846, 969.0451928067296, 969.1945306163745, 969.3438684260195, 969.8921274072834, 970.0414652169284, 970.1908030265733, 970.7390620087546, 970.8883998183995, 971.0377376280445, 971.5859966102257, 971.7353344198707, 971.8846722295157, 972.4329312107795, 972.5822690204245, 972.7316068300695, 972.8809446397246, 973.2798658122506, 973.4292036218956, 973.5785414315405, 973.7278792411958, 974.1268004137218, 974.2761382233667, 974.4254760330117, 974.5748138426668, 975.1230728239207, 975.2724106335656, 975.4217484432207, 975.9700074253917, 976.1193452350367, 976.2686830446919, 976.8169420259457, 976.9662798355906, 977.1156176452457, 977.6638766274168, 977.8132144370618, 977.9625522467168, 978.1118900563617, 978.5108112288879, 978.6601490385328, 978.8094868481879, 978.9588246578329, 979.3577458294418, 979.5070836390868, 979.6564214487419, 979.8057592583868, 980.3540182405578, 980.5033560502129, 980.6526938598579, 981.200952842029, 981.350290651684, 981.4996284613289, 982.0478874425828, 982.197225252238, 982.346563061883, 982.495900871528, 982.894822044054, 983.0441598537091, 983.193497663354, 983.342835472999, 983.7417566455251, 983.8910944551801, 984.0404322648251, 984.1897700744701, 984.738029055734, 984.887366865379, 985.036704675024, 985.5849636572052, 985.7343014668502, 985.8836392764952, 986.4318982586763, 986.5812360683212, 986.7305738779662, 987.2788328592302, 987.4281706688752, 987.5775084785201, 987.7268462881651, 988.1257674607012, 988.2751052703462, 988.4244430799912, 988.5737808896362, 988.9727020612552, 989.1220398709002, 989.2713776805451, 989.4207154901901, 989.9689744723712, 990.1183122820162, 990.2676500916612, 990.8159090738424, 990.9652468834873, 991.1145846931323, 991.6628436743963, 991.8121814840413, 991.9615192936863, 992.5097782758673, 992.6591160855123, 992.8084538951573, 992.9577917048124, 993.3567128773384, 993.5060506869834, 993.6553884966283, 993.8047263062836, 994.2036474778924, 994.3529852875374, 994.5023230971824, 994.6516609068374, 995.1999198890085, 995.3492576986534, 995.4985955083085, 996.0468544904795, 996.1961923001245, 996.3455301097796, 996.8937890910335, 997.0431269006784, 997.1924647103335, 997.3418025199785, 997.7407236925046, 997.8900615021496, 998.0393993118046, 998.1887371214495, 998.5876582930584, 998.7369961027034, 998.8863339123586, 999.0356717220036, 999.5839307041746, 999.7332685138297, 999.8826063234746, 1000.4308653056456, 1000.5802031153007, 1000.7295409249457, 1001.2777999061996, 1001.4271377158547, 1001.5764755254996, 1002.1247345076706, 1002.2740723173258, 1002.4234101269708, 1002.5727479366158, 1002.9716691091418, 1003.1210069187969, 1003.2703447284418, 1003.4196825380868, 1003.8186037096957, 1003.9679415193507, 1004.1172793289957, 1004.2666171386406, 1004.8148761208219, 1004.9642139304668, 1005.1135517401118, 1005.661810722293, 1005.811148531938, 1005.960486341583, 1006.5087453228468, 1006.6580831324918, 1006.8074209421368, 1007.355679924318, 1007.505017733963, 1007.654355543608, 1007.8036933532529, 1008.202614525789, 1008.351952335434, 1008.501290145079, 1008.650627954724, 1009.049549126343, 1009.198886935988, 1009.3482247456329, 1009.4975625552779, 1010.045821537459, 1010.195159347104, 1010.344497156749, 1010.892756138013, 1011.042093947658, 1011.191431757303, 1011.7396907394841, 1011.8890285491291, 1012.038366358774, 1012.187704168429, 1012.5866253409552, 1012.7359631506001, 1012.8853009602451, 1013.0346387699002, 1013.4335599415091, 1013.5828977511541, 1013.732235560799, 1013.8815733704541, 1014.4298323526252, 1014.5791701622702, 1014.7285079719252, 1015.2767669540963, 1015.4261047637413, 1015.5754425733963, 1016.1237015546501, 1016.2730393642951, 1016.4223771739503, 1016.9706361561213, 1017.1199739657662, 1017.2693117754213, 1017.4186495850663, 1017.8175707575924, 1017.9669085672374, 1018.1162463768924, 1018.2655841865374, 1018.6645053581462, 1018.8138431677912, 1018.9631809774464, 1019.1125187870914, 1019.6607777692624, 1019.8101155789175, 1019.9594533885625, 1020.5077123698163, 1020.6570501794713, 1020.8063879891163, 1021.3546469712874, 1021.5039847809425, 1021.6533225905874, 1022.2015815727584, 1022.3509193824136, 1022.5002571920586, 1022.6495950017036, 1023.0485161733125, 1023.1978539829674, 1023.3471917926124, 1023.4965296022574, 1023.8954507747835, 1024.0447885844385, 1024.1941263940835, 1024.3434642037284, 1024.8917231859095, 1025.0410609955547, 1025.1903988051995, 1025.7386577864636, 1025.8879955961086, 1026.0373334057535, 1026.5855923879346, 1026.7349301975796, 1026.8842680072246, 1027.0336058168696, 1027.4325269894057, 1027.581864799051, 1027.7312026086956, 1027.8805404183408, 1028.2794615899597, 1028.4287993996047, 1028.5781372092497, 1028.7274750188947, 1029.2757340010758, 1029.4250718107207, 1029.5744096203657, 1030.1226686025468, 1030.2720064121918, 1030.4213442218368, 1030.9696032031009, 1031.1189410127458, 1031.2682788223908, 1031.816537804572, 1031.9658756142169, 1032.1152134238619, 1032.2645512335168, 1032.6634724051257, 1032.8128102147707, 1032.9621480244157, 1033.111485834071, 1033.5104070065968, 1033.659744816242, 1033.8090826258867, 1033.958420435542, 1034.506679417713, 1034.656017227358, 1034.805355037013, 1035.3536140182669, 1035.5029518279118, 1035.652289637567, 1036.200548619738, 1036.3498864293829, 1036.499224239038, 1037.047483221209, 1037.1968210308542, 1037.3461588405091, 1037.495496650154, 1037.894417821763, 1038.043755631408, 1038.193093441063, 1038.3424312507082, 1038.741352423234, 1038.890690232879, 1039.0400280425342, 1039.1893658521792, 1039.73762483435, 1039.8869626440053, 1040.0363004536503, 1040.5845594349041, 1040.733897244559, 1040.883235054204, 1041.4314940363752, 1041.5808318460304, 1041.7301696556751, 1041.8795074653203, 1042.2784286369292, 1042.4277664465842, 1042.5771042562292, 1042.7264420658742, 1043.1253632384003, 1043.2747010480552, 1043.4240388577002, 1043.5733766673452, 1044.1216356495263, 1044.2709734591713, 1044.4203112688162, 1044.9685702500803, 1045.1179080597253, 1045.2672458693703, 1045.8155048515514, 1045.9648426611964, 1046.1141804708413, 1046.6624394530224, 1046.8117772626674, 1046.9611150723124, 1047.1104528819574, 1047.5093740535763, 1047.6587118632215, 1047.8080496728662, 1047.9573874825114, 1048.3563086550475, 1048.5056464646925, 1048.6549842743375, 1048.8043220839825, 1049.3525810661636, 1049.5019188758085, 1049.6512566854535]
    surf_example_y = \
    [956.1919473266602, 952.7501062011719, 957.1215254720053, 957.7245542689732, 956.4077193196615, 957.6851495361328, 956.8282388305664, 957.9599374389649, 957.9445718383789, 951.6826013183594, 954.1140181477865, 958.3258610026041, 958.4543705240885, 951.9588972981771, 954.9566288248698, 959.0417016601563, 959.9855737304688, 951.4666589355469, 955.3889459228516, 958.891728108724, 959.7696755981445, 951.4767297363281, 955.5766951497396, 956.9448083496094, 958.255751953125, 954.7212976074219, 957.385146484375, 958.6429208374024, 956.4187361653646, 956.8644352213541, 958.0027459716797, 957.1565698242188, 959.3516178385416, 959.762598063151, 959.1551965332031, 959.4062733677456, 961.7827120535715, 961.87494140625, 962.6480205426897, 960.653441772461, 961.8231783621652, 961.9499963378906, 960.4276208496094, 958.2767650010851, 960.864030863444, 960.1220985243056, 957.5699914550781, 958.1696313476563, 959.290674235026, 956.4149926757813, 956.3924020385742, 956.4216149902344, 957.4158837890625, 956.4658654785156, 956.3176034545899, 957.8153833007813, 957.1758700125558, 956.4470513916016, 957.4515985107422, 957.073368733724, 956.7520440673828, 956.5279280598959, 956.2967218017578, 957.1254622395834, 956.4517282104492, 956.4574426269531, 956.4836419677735, 956.3704522705078, 956.4174951171875, 956.6027062988281, 956.2730249023438, 956.4597924804688, 956.5859318033854, 955.9211673990885, 956.2102604166666, 956.5858605957031, 956.7078698730469, 955.7340539550781, 955.9810021972656, 956.2812265014649, 956.4326013183594, 955.2138208007813, 955.4766381835938, 956.0532983398438, 956.2238916015625, 955.2367471313477, 955.9427026367188, 956.2776330566406, 955.3388920084635, 955.6464990234375, 956.326961669922, 955.3241571044922, 955.6762333170573, 955.9149011230469, 956.3288313802084, 955.5126031494141, 955.7298018391928, 955.9978479003906, 956.4377587890625, 955.5233707682291, 955.876835530599, 956.164433186849, 956.661399230957, 955.5488122558594, 956.049582824707, 956.212528889974, 955.6656945800781, 955.7433984375, 956.3709252929688, 955.2571405029297, 955.7240441894531, 956.1821252441407, 955.7840493774414, 956.2384586588541, 955.8172906494141, 956.2864831542969, 955.0754846191406, 955.3732548014323, 955.939823811849, 956.6385339355469, 955.5382165527344, 956.3270003255209, 956.2347609456381, 956.782597249349, 955.8473504638672, 955.9604028320313, 957.070439046224, 955.97474609375, 956.5207971191406, 957.3256448364258, 956.4350915527343, 956.3608646647135, 957.0790856933594, 956.148330078125, 956.5481103515625, 957.3426965332031, 956.8927657063803, 956.1864465332031, 956.8372644042969, 956.8146661376953, 956.1936138044084, 954.7510217285156, 954.9857019042969, 955.0787957763672, 955.6125024414063, 954.7483514404297, 955.0489038085938, 955.5597985839844, 954.8217004394531, 955.6599114990235, 955.3119958496094, 956.2336979166666, 955.5779489135742, 955.5139916992188, 955.9076684570313, 956.3365319824219, 955.5135949707031, 955.5844873046875, 955.7292016601563, 955.0918420410156, 955.3083032226563, 955.6528059895834, 956.0290266927084, 955.5779565429688, 955.7924035644531, 956.1822351074219, 955.6085961914063, 955.9919427490235, 956.2282759602865, 955.7048944091797, 956.0207971191406, 956.4893029785156, 955.6006463623047, 956.0875466918945, 956.3781503295899, 956.9724267578125, 956.1193994140625, 956.3942712402344, 956.7601007080078, 957.0035699462891, 956.2975915527344, 956.6487115478516, 956.9027856445313, 957.2297509765625, 957.2133020019531, 957.4456475830078, 957.388793334961, 957.1123498535156, 957.6234216308594, 957.707422281901, 958.2371667480469, 958.1577676391602, 958.1114587402344, 958.5519982910157, 958.4655348714193, 958.2812951660156, 958.1065286254883, 958.3735269165039, 958.5073388671875, 958.9232995605469, 958.7940744018555, 958.2069543457031, 958.3961938476563, 958.7869104003906, 959.5608361816406, 959.2884362792969, 959.7298608398437, 960.030524597168, 961.9714807128906, 960.8886356608073, 961.7954782104492, 960.8300469970703, 961.9818566894531, 963.9234880065918, 963.4840386962891, 962.143676147461, 963.1614404296874, 964.8104127502442, 965.345653963956, 965.150454864502, 964.6044850376675, 964.084352155413, 966.105598929269, 962.9308516438803, 960.0037072753906, 963.6774743652344, 964.2602423967635, 967.7048295593262, 966.5820415387834, 964.1615306260851, 970.7093957519531, 971.0182752574574, 965.4244088745118, 968.5559106445312, 971.9646919389204, 964.0016702270508, 962.0568307495117, 968.1055531529018, 968.8846039496527, 966.7297296142578, 961.5432389831543, 963.9685946219308, 967.0483392333985, 966.7555612182617, 961.2168572998047, 963.7506685965402, 964.0950006103516, 962.1281045532227, 961.732967529297, 961.4878533935547, 961.0330590820313, 961.4729821777344, 963.9265791829428, 960.2963098144531, 962.7224496459961, 966.5991459147135, 967.4252382590554, 961.8297799682617, 963.8630517578125, 969.3155419921875, 971.5289224243164, 960.7906182861328, 965.39662109375, 970.3552596028646, 973.4220193481445, 963.9255110677084, 969.5247513253348, 971.6707788085937, 962.1638024902344, 966.5644982910156, 970.7267558942522, 964.445578918457, 965.4204858398438, 968.4746850585938, 970.8165963745117, 965.0901897321428, 967.4454644775391, 968.9058679199219, 970.514052734375, 966.6759606933595, 966.6060988362631, 967.3642877197266, 970.8430360412598, 965.1454614257813, 965.5219018554687, 968.0993086751303, 964.5990441894531, 966.3527795410157, 970.0733941650391, 965.9201704915365, 968.8714288330078, 971.6430755060369, 966.7245515441895, 970.6317742919922, 972.9070123291016, 978.862326965332, 968.7082462565104, 971.5331262207031, 975.22203511556, 978.2590417480469, 970.5865548706055, 972.8326486206055, 975.0765004185268, 978.0550805664063, 969.979101784446, 975.5256188964844, 976.4511763509115, 967.282129313151, 973.1129994419643, 972.1475747680664, 967.4084880719865, 969.724486694336, 971.8129927571615, 965.9207421875001, 965.060185139974, 964.9158878580729, 973.295549054827, 961.5030969238281, 961.3472334798178, 961.9002221679688, 973.8801721191406, 960.3726342773438, 960.8580010986328, 966.5058418104384, 966.6174996948242, 970.4757989501953, 971.111461452908, 969.5693124389649, 970.0187168375651, 971.712783203125, 969.2176321072048, 967.7798128836496, 969.1474857584635, 967.8990347567471, 965.4619948323568, 964.591674194336, 965.5590299224854, 965.2235192871094, 963.6461938476563, 965.0403414481027, 964.5363916015625, 964.83119140625, 968.0106042480469, 965.3783664957682, 966.7820987955729, 968.1876519775391, 963.7134698486328, 965.2241357421875, 966.5399133300782, 963.3088525390625, 966.5004571533203, 967.7788766479492, 963.9860009765625, 965.0265126255581, 964.6028855895996, 965.4001992797852, 967.439824594351, 967.3076776123047, 966.7678063964844, 964.6798954264323, 970.4159730529785, 971.0735375976562, 968.5930284118652, 964.3151147460937, 971.2714481608073, 969.8778756713867, 965.2531427001953, 974.3320726013184, 970.8310973103842, 970.4819126383463, 976.4069512939453, 972.8792742598685, 972.42689453125, 974.2537424879808, 972.6075611368815, 972.9829625028723, 969.4068017578124, 975.6900272623698, 972.4542604758523, 969.244341430664, 966.4756860351563, 972.1055618722098, 971.0410746626421, 968.6701738823785, 968.484980579723, 970.1320985412598, 966.8150361633301, 968.1735419573104, 965.9918918863932, 967.3265985107422, 967.1936486816406, 968.258534601385, 965.6647241210937, 964.7685540771485, 969.9918283081055, 972.3812180397728, 969.0385786946615, 964.483046875, 966.1623376464844, 970.4791162109375, 970.777610168457, 963.4342594401041, 963.9653263346354, 966.3435154215495, 963.3390751139323, 963.8469766235352, 962.9853356933594, 962.889670715332, 963.8027693684896, 962.5465997314453, 962.6067498779297, 962.7232507324219, 962.7254251098633, 962.5558374023437, 961.8852278645834, 962.3962319946289, 960.8386275227865, 961.1550286865235, 961.2548822021485, 961.4765924072266, 960.6184991455078, 961.9651483154297, 961.4277947998047, 962.5367985026041, 963.7498559570313, 964.9357385253907, 965.131250406901, 965.8292535400391, 965.724616394043, 968.2106393432617, 968.949599609375, 970.4578647867838, 967.5019847276476, 970.8805383300781, 965.3939965820313, 968.8996404266358, 967.0795373535157, 967.5002893066406, 968.4345001898871, 966.5278771972656, 964.8944787597657, 965.7829939778646, 964.417627360026, 961.6715997314453, 963.7585813685826, 965.5776688058036, 964.3091600623497, 963.197875366211, 961.60875386556, 961.2176354980469, 961.9915002441406, 960.4592736816406, 961.0073083496094, 961.7334639485678, 962.0717716471354, 962.0322462972006, 962.4461755371094, 962.4341027832031, 962.4083322143555, 962.9922631835938, 965.3113168334961, 965.2543969726562, 964.0677217102051, 968.2192529296875, 967.7699365234375, 967.3213586425782, 965.7838891601563, 968.2995141601563, 967.0132165527343, 965.9553369140625, 966.0198632812501, 965.0457554117838, 965.1445865885416, 964.3784020996094, 963.9323368326823, 962.721572265625, 964.1943811035156, 964.8622430419922, 965.3469995117188, 964.2426424734933, 962.0558129882813, 962.7627709960938, 964.5389779663086, 962.7944482421875, 961.8270918782553, 963.2644952392578, 962.1696466064453, 960.5331750488281, 960.3108514404297, 961.6684411621094, 963.1624566650391, 961.7882684326172, 960.1095079040527, 961.2196445719401, 960.927637125651, 960.3467960611979, 959.9565805053711, 960.3027795410156, 959.1747735595703, 959.7868493652344, 959.9240738351004, 959.2475078473772, 958.615599975586, 958.9692224121094, 959.9756616210938, 960.5763594563803, 960.3158512369791, 960.458866780599, 959.5802987670899, 959.7753951009115, 960.4528039550781, 959.4015649414063, 959.7812951660156, 959.259154663086, 959.5087045288086, 958.5901228841146, 959.6593316650391, 959.0800775146485, 959.3381951904297, 957.5351937866211, 958.610373840332, 958.3811486816406, 958.7541528320312, 956.3264916992188, 958.3356958007812, 958.8702355957032, 956.3979943847656, 957.943730061849, 958.9182763671874, 956.0629113769531, 957.2303206380209, 958.2478021240235, 955.9738916015625, 956.5228173828125, 957.4301904296875, 957.9627628580729, 955.3259118652344, 955.9082940673828, 957.2907250976563, 957.7183984375, 955.1421960449219, 955.487695719401, 956.0469506835938, 957.1351973470053, 955.3414910888672, 955.8319645182291, 956.5566857910156, 955.1287276204428, 955.4871667480469, 955.9366296386719, 955.2009423828125, 955.523803100586, 955.755248413086, 955.1372979736328, 955.3419641113281, 955.7412357584635, 956.5390542602539, 954.7999566650391, 955.4786319986979, 955.6432946777344, 955.9235375976563, 955.0244897460938, 955.08705078125, 955.7236016845703, 956.3931624348959, 955.0504678344727, 955.704596862793, 956.3340829467774, 955.3090051269531, 955.3449548339844, 956.0143502807617, 955.1374505615235, 955.5658614095053, 956.0410709635416, 956.4827315266928, 955.0333093261719, 955.4631290690104, 955.7038924153646, 955.994765625, 955.0842279052735, 955.1863092041016, 955.6206506347656, 956.7455489095053, 956.1826623535156, 956.2316634114584, 957.0656274414063, 955.7472375488281, 956.0182489013672, 956.041396484375, 955.9177596028646, 956.3810510253907, 956.2058023071289, 956.3268502807617, 956.4053002929688, 956.1168908691407, 955.961448059082, 955.7115701293945, 956.0112349446615, 955.8839944458008, 955.2492364501953, 955.1069278971354, 955.681034749349, 955.2644494628906, 955.187392578125, 955.2409143066407, 955.312392578125, 955.3147424316406]
    grnd_example_x = \
    [900.0037268886355, 900.5519858698893, 900.7013236795343, 900.8506614891894, 901.3989204722775, 901.5482582819225, 901.6975960915777, 901.8469339012227, 902.2458550728315, 902.3951928824765, 902.5445306921315, 902.6938685017765, 903.0927896733854, 903.2421274830303, 903.3914652926856, 903.5408031023305, 904.0890620854186, 904.2383998950738, 904.3877377047188, 904.9359966859727, 905.0853344956276, 905.2346723052726, 905.7829312865265, 905.9322690961816, 906.0816069058266, 906.2309447154715, 906.6298658889148, 906.7792036985699, 906.9285415082148, 907.0778793178598, 907.4768004894687, 907.6261382991238, 907.7754761087688, 907.9248139184137, 908.3237350900226, 908.4730728996777, 908.6224107093227, 908.7717485189677, 909.3200075020659, 909.4693453117109, 909.6186831213558, 910.1669421026199, 910.3162799122649, 910.4656177219099, 911.0138767031738, 911.1632145128187, 911.3125523224637, 911.4618901321087, 911.860811305562, 912.010149115207, 912.159486924852, 912.308824734497, 912.7077459061161, 912.8570837157611, 913.006421525406, 913.155759335051, 913.7040183163149, 913.8533561259599, 914.0026939356048, 914.5509529187032, 914.7002907283481, 914.8496285379931, 915.3978875192571, 915.5472253289021, 915.696563138547, 916.244822119811, 916.394159929456, 916.543497739101, 916.692835548746, 917.0917567221993, 917.2410945318443, 917.3904323414893, 917.5397701511342, 917.9386913227531, 918.0880291323981, 918.2373669420431, 918.3867047516881, 918.9349637329522, 919.0843015425971, 919.2336393522421, 919.7818983353404, 919.9312361449854, 920.0805739546304, 920.6288329358943, 920.7781707455392, 920.9275085551842, 921.0768463648394, 921.4757675364482, 921.6251053460932, 921.7744431557381, 921.9237809653932, 922.3227021370021, 922.4720399466471, 922.6213777562921, 922.7707155659472, 923.1696367393904, 923.3189745490354, 923.4683123586804, 923.6176501683354, 924.1659091495893, 924.3152469592343, 924.4645847688894, 925.0128437501432, 925.1621815597882, 925.3115193694432, 925.8597783525315, 926.0091161621765, 926.1584539718315, 926.3077917814765, 926.7067129530853, 926.8560507627303, 927.0053885723855, 927.1547263820305, 927.5536475536394, 927.7029853632844, 927.8523231729394, 928.0016609825843, 928.5499199656726, 928.6992577753276, 928.8485955849726, 929.3968545662265, 929.5461923758816, 929.6955301855265, 930.2437891667804, 930.3931269764355, 930.5424647860805, 931.0907237691687, 931.2400615788238, 931.3893993884687, 931.5387371981137, 931.9376583697226, 932.0869961793777, 932.2363339890227, 932.3856717986677, 932.7845929702764, 932.9339307799316, 933.0832685895766, 933.2326063992216, 933.7808653823199, 933.9302031919649, 934.0795410016099, 934.6277999828737, 934.7771377925187, 934.9264756021637, 935.4747345834278, 935.6240723930728, 935.7734102027177, 935.9227480123627, 936.3216691858161, 936.471006995461, 936.620344805106, 936.769682614751, 937.1686037863699, 937.3179415960149, 937.4672794056598, 937.6166172153048, 938.0155383869238, 938.1648761965688, 938.3142140062138, 938.4635518158588, 939.0118107989571, 939.161148608602, 939.310486418247, 939.858745399511, 940.008083209156, 940.157421018801, 940.7056800000648, 940.8550178097098, 941.0043556193548, 941.15369342901, 941.5526146024531, 941.7019524120981, 941.851290221743, 942.0006280313983, 942.3995492030072, 942.5488870126521, 942.6982248222971, 942.8475626319521, 943.395821613206, 943.5451594228509, 943.6944972325061, 944.24275621376, 944.392094023405, 944.54143183306, 945.0896908161482, 945.2390286257931, 945.3883664354482, 945.9366254167021, 946.0859632263471, 946.2353010360022, 946.3846388456471, 946.783560017256, 946.932897826901, 947.0822356365561, 947.2315734462011, 947.6304946196443, 947.7798324292893, 947.9291702389444, 948.0785080485894, 948.6267670298432, 948.7761048394983, 948.9254426491433, 949.473701630397, 949.6230394400523, 949.7723772496972, 950.3206362327853, 950.4699740424405, 950.6193118520855, 951.1675708333394, 951.3169086429943, 951.4662464526393, 951.6155842622843, 952.0145054338932, 952.1638432435484, 952.3131810531934, 952.4625188628384, 952.8614400362815, 953.0107778459366, 953.1601156555815, 953.3094534652265, 953.8577124464905, 954.0070502561355, 954.1563880657804, 954.7046470470444, 954.8539848566894, 955.0033226663344, 955.5515816494327, 955.7009194590777, 955.8502572687227, 955.9995950783676, 956.3985162499866, 956.5478540596316, 956.6971918692766, 956.8465296789216, 957.2454508505405, 957.3947886601854, 957.5441264698304, 957.6934642794754, 958.2417232625737, 958.3910610722187, 958.5403988818637, 959.0886578631278, 959.2379956727727, 959.3873334824177, 959.9355924636816, 960.0849302733266, 960.2342680829715, 960.7825270660699, 960.9318648757148, 961.0812026853598, 961.230540495015, 961.6294616666238, 961.7787994762688, 961.9281372859137, 962.0774750955688, 962.4763962671777, 962.6257340768227, 962.7750718864677, 962.9244096961228, 963.472668679211, 963.622006488856, 963.771344298511, 964.3196032797649, 964.4689410894099, 964.618278899065, 965.1665378803189, 965.3158756899638, 965.4652134996188, 966.0134724808727, 966.1628102905177, 966.3121481001729, 966.4614859098178, 966.860407083261, 967.0097448929059, 967.1590827025611, 967.3084205122061, 967.707341683815, 967.85667949346, 968.006017303115, 968.1553551127599, 968.7036140940138, 968.8529519036689, 969.0022897133139, 969.5505486964021, 969.6998865060572, 969.8492243157021, 970.397483296956, 970.5468211066111, 970.6961589162561, 970.8454967259011, 971.24441789751, 971.393755707165, 971.54309351681, 971.692431326455, 972.0913524998982, 972.2406903095533, 972.3900281191983, 972.5393659288433, 973.0876249101073, 973.2369627197522, 973.3863005293972, 973.9345595106611, 974.083897320306, 974.233235129951, 974.7814941130493, 974.9308319226943, 975.0801697323393, 975.6284287136034, 975.7777665232484, 975.9271043328934, 976.0764421425383, 976.4753633141572, 976.6247011238022, 976.7740389334472, 976.9233767430921, 977.3222979165455, 977.4716357261905, 977.6209735358354, 977.7703113454804, 978.3185703267444, 978.4679081363894, 978.6172459460345, 979.1655049272983, 979.3148427369433, 979.4641805465883, 980.0124395296866, 980.1617773393316, 980.3111151489766, 980.8593741302404, 981.0087119398854, 981.1580497495305, 981.3073875591856, 981.7063087307945, 981.8556465404395, 982.0049843500844, 982.1543221597394, 982.5532433331828, 982.7025811428277, 982.8519189524727, 983.0012567621277, 983.5495157433816, 983.6988535530267, 983.8481913626817, 984.3964503439355, 984.5457881535806, 984.6951259632356, 985.2433849463238, 985.3927227559689, 985.5420605656238, 985.6913983752688, 986.0903195468777, 986.2396573565227, 986.3889951661778, 986.5383329758228, 986.9372541474316, 987.0865919570767, 987.2359297667317, 987.3852675763767, 987.9335265576306, 988.0828643672857, 988.2322021769306, 988.7804611600188, 988.9297989696738, 989.0791367793188, 989.6273957605728, 989.7767335702279, 989.9260713798728, 990.4743303611267, 990.6236681707817, 990.7730059804267, 990.9223437900717, 991.321264963515, 991.47060277317, 991.6199405828149, 991.76927839246, 992.1681995640689, 992.317537373724, 992.466875183369, 992.616212993014, 993.1644719742778, 993.3138097839228, 993.4631475935678, 994.0114065766661, 994.1607443863111, 994.310082195956, 994.85834117722, 995.007678986865, 995.1570167965101, 995.705275777774, 995.854613587419, 996.0039513970639, 996.1532892067089, 996.5522103801623, 996.7015481898072, 996.8508859994522, 997.0002238090972, 997.3991449807161, 997.548482790361, 997.6978206000061, 997.8471584096511, 998.3954173909151, 998.5447552005601, 998.694093010205, 999.2423519933034, 999.3916898029483, 999.5410276125933, 1000.0892865938572, 1000.2386244035023, 1000.3879622131473, 1000.5373000228024, 1000.9362211944111, 1001.0855590040562, 1001.2348968137012, 1001.3842346233562, 1001.7831557967994, 1001.9324936064445, 1002.0818314160895, 1002.2311692257445, 1002.7794282069983, 1002.9287660166433, 1003.0781038262984, 1003.6263628075524, 1003.7757006171973, 1003.9250384268523, 1004.4732974099406, 1004.6226352195856, 1004.7719730292406, 1005.3202320104945, 1005.4695698201394, 1005.6189076297944, 1005.7682454394395, 1006.1671666110484, 1006.3165044206934, 1006.4658422303485, 1006.6151800399934, 1007.0141012134367, 1007.1634390230817, 1007.3127768327367, 1007.4621146423817, 1008.0103736236356, 1008.1597114332906, 1008.3090492429357, 1008.8573082241894, 1009.0066460338445, 1009.1559838434896, 1009.7042428247435, 1009.8535806343984, 1010.0029184440434, 1010.5511774271317, 1010.7005152367867, 1010.8498530464317, 1010.9991908560767, 1011.3981120276856, 1011.5474498373407, 1011.6967876469857, 1011.8461254566307, 1012.2450466282395, 1012.3943844378946, 1012.5437222475396, 1012.6930600571845, 1013.2413190402829, 1013.3906568499278, 1013.5399946595728, 1014.0882536408367, 1014.2375914504818, 1014.3869292601267, 1014.9351882413907, 1015.0845260510357, 1015.2338638606807, 1015.3832016703257, 1015.782122843779, 1015.931460653424, 1016.080798463069, 1016.2301362727139, 1016.6290574443328, 1016.7783952539778, 1016.9277330636228, 1017.0770708732678, 1017.6253298545319, 1017.7746676641768, 1017.9240054738218, 1018.4722644569201, 1018.6216022665651, 1018.7709400762101, 1019.319199057474, 1019.4685368671189, 1019.6178746767639, 1020.1661336580279, 1020.3154714676729, 1020.4648092773178, 1020.6141470869729, 1021.0130682604162, 1021.1624060700611, 1021.3117438797061, 1021.4610816893612, 1021.8600028609701, 1022.0093406706151, 1022.15867848026, 1022.3080162899151, 1022.856275271169, 1023.005613080814, 1023.1549508904691, 1023.7032098735573, 1023.8525476832023, 1024.0018854928574, 1024.5501444741112, 1024.6994822837562, 1024.8488200934112, 1025.397079074665, 1025.54641688431, 1025.6957546939652, 1025.8450925036102, 1026.2440136770533, 1026.3933514866983, 1026.5426892963535, 1026.6920271059985, 1027.0909482776074, 1027.2402860872523, 1027.3896238969073, 1027.5389617065523, 1028.0872206878062, 1028.2365584974614, 1028.3858963071061, 1028.9341552901944, 1029.0834930998494, 1029.2328309094946, 1029.7810898907483, 1029.9304277004035, 1030.0797655100484, 1030.2291033196934, 1030.6280244913023, 1030.7773623009575, 1030.9267001106023, 1031.0760379202475, 1031.4749590918564, 1031.6242969015113, 1031.7736347111563, 1031.9229725208013, 1032.4712315038996, 1032.6205693135446, 1032.7699071231896, 1033.3181661044534, 1033.4675039140984, 1033.6168417237434, 1034.1651007050075, 1034.3144385146525, 1034.4637763242974, 1035.0120353073958, 1035.1613731170407, 1035.3107109266857, 1035.4600487363307, 1035.8589699079496, 1036.0083077175946, 1036.1576455272395, 1036.3069833368845, 1036.7059045085034, 1036.8552423181486, 1037.0045801277934, 1037.1539179374386, 1037.7021769205367, 1037.8515147301819, 1038.0008525398266, 1038.5491115210907, 1038.6984493307357, 1038.8477871403807, 1039.3960461216448, 1039.5453839312895, 1039.6947217409347, 1040.2429807240328, 1040.392318533678, 1040.5416563433228, 1040.690994152968, 1041.0899153245869, 1041.2392531342318, 1041.3885909438768, 1041.5379287535218, 1041.9368499251407, 1042.0861877347857, 1042.2355255444306, 1042.3848633540756, 1042.933122337174, 1043.082460146819, 1043.2317979564639, 1043.780056937728, 1043.929394747373, 1044.078732557018, 1044.6269915382818, 1044.7763293479268, 1044.9256671575718, 1045.075004967227, 1045.47392614067, 1045.623263950315, 1045.77260175996, 1045.921939569615, 1046.320860741224, 1046.470198550869, 1046.6195363605138, 1046.768874170169, 1047.317133151423, 1047.466470961068, 1047.615808770723, 1048.1640677538112, 1048.3134055634562, 1048.4627433731112, 1049.011002354365, 1049.16034016401, 1049.3096779736652, 1049.857936954919]
    grnd_example_y = \
    [951.9698486328125, 950.803466796875, 951.3915405273438, 952.1591796875, 950.6665649414062, 951.0491333007812, 951.3530883789062, 951.6505737304688, 950.69482421875, 950.74169921875, 951.3157348632812, 951.4473876953125, 950.4194946289062, 951.050537109375, 951.2578735351562, 951.512939453125, 951.3143310546875, 951.5767211914062, 951.6946411132812, 951.2222290039062, 952.0372924804688, 952.0623168945312, 951.4840698242188, 952.17529296875, 952.4064331054688, 954.3394775390625, 951.400390625, 951.8389282226562, 952.6390991210938, 955.1039428710938, 951.784423828125, 952.105224609375, 953.3250122070312, 955.7918701171875, 952.1222534179688, 952.5458374023438, 953.701171875, 955.4111328125, 953.0687255859375, 954.1258544921875, 955.7410888671875, 953.778564453125, 954.9689331054688, 956.0704956054688, 954.68310546875, 955.3486328125, 956.629150390625, 957.7388916015625, 954.9786376953125, 956.4268188476562, 957.1858520507812, 957.5151977539062, 956.1990356445312, 956.6842041015625, 956.9889526367188, 957.0906982421875, 956.9503784179688, 956.890380859375, 956.7975463867188, 956.6757202148438, 956.7518310546875, 956.6326293945312, 956.4896240234375, 956.6754150390625, 956.6063232421875, 956.236083984375, 956.501708984375, 956.6334838867188, 956.5880737304688, 956.0410766601562, 956.4109497070312, 956.5277099609375, 956.4623413085938, 955.7578125, 956.0743408203125, 956.42724609375, 956.5323486328125, 955.6431884765625, 956.2151489257812, 956.4930419921875, 955.3030395507812, 955.682861328125, 956.2455444335938, 954.9616088867188, 955.3803100585938, 955.8989868164062, 956.4014892578125, 955.033203125, 955.4624633789062, 955.681396484375, 956.12890625, 954.7454223632812, 955.1973266601562, 955.20947265625, 955.992919921875, 955.0689697265625, 955.3029174804688, 955.5844116210938, 955.5831298828125, 955.433349609375, 955.5106201171875, 955.7809448242188, 955.4334716796875, 955.5431518554688, 955.6842651367188, 955.299072265625, 955.3488159179688, 955.46923828125, 955.6232299804688, 955.1497802734375, 955.0492553710938, 955.3782348632812, 955.4039306640625, 955.0621948242188, 955.3004150390625, 955.513916015625, 955.6686401367188, 955.0662231445312, 955.4966430664062, 955.9943237304688, 955.075439453125, 955.3258056640625, 955.6937866210938, 954.97412109375, 955.35546875, 955.5578002929688, 954.7835083007812, 955.2103271484375, 955.6080322265625, 955.704345703125, 954.7046508789062, 955.0628051757812, 955.4510498046875, 955.7449951171875, 954.7508544921875, 955.014404296875, 955.3023681640625, 955.7989501953125, 954.72900390625, 955.1319580078125, 955.6826782226562, 954.3633422851562, 954.8078002929688, 955.3179931640625, 954.015869140625, 954.468017578125, 955.0193481445312, 955.4898681640625, 953.7225952148438, 954.218017578125, 954.8690185546875, 954.9595336914062, 953.65087890625, 954.36572265625, 954.6544189453125, 955.1212158203125, 953.4661865234375, 954.2703247070312, 954.8539428710938, 955.5139770507812, 954.6749877929688, 955.16259765625, 955.58447265625, 954.831787109375, 955.3082885742188, 955.5812377929688, 955.0490112304688, 955.2678833007812, 955.62646484375, 955.9877319335938, 955.1873168945312, 955.6626586914062, 955.7891845703125, 956.0269775390625, 955.2826538085938, 955.6085815429688, 955.9288330078125, 956.2258911132812, 955.7824096679688, 956.048095703125, 956.2255859375, 955.872314453125, 956.360595703125, 956.5514526367188, 956.18359375, 956.5181274414062, 956.7745971679688, 956.4237060546875, 956.6759033203125, 957.083251953125, 957.2508544921875, 956.569580078125, 957.0457153320312, 957.1893920898438, 957.3273315429688, 957.3072509765625, 957.0379638671875, 957.4259643554688, 957.1752319335938, 957.826904296875, 958.0187377929688, 957.93115234375, 957.9099731445312, 958.1748046875, 958.5150146484375, 958.0506591796875, 958.3114013671875, 958.3765258789062, 958.1466064453125, 958.1509399414062, 958.535400390625, 958.8740844726562, 958.326416015625, 958.5184936523438, 958.87451171875, 959.2557373046875, 958.5718383789062, 959.1136474609375, 959.47216796875, 959.8883666992188, 959.5482177734375, 959.9962768554688, 960.3592529296875, 959.7324829101562, 960.1329956054688, 960.4293212890625, 959.666259765625, 960.0343017578125, 960.2705688476562, 960.4888305664062, 959.6236572265625, 959.78564453125, 960.0513305664062, 960.4968872070312, 959.6378173828125, 959.933837890625, 960.1669311523438, 960.4651489257812, 960.0245361328125, 960.1686401367188, 960.3629760742188, 959.9198608398438, 960.1663208007812, 960.5455322265625, 959.9606323242188, 960.2394409179688, 960.6190795898438, 960.1055297851562, 960.3157958984375, 960.6802368164062, 960.9116821289062, 959.8566284179688, 960.6297607421875, 960.7259521484375, 961.1176147460938, 959.9495239257812, 960.3685913085938, 960.6490478515625, 961.4014892578125, 960.4852294921875, 960.6091918945312, 960.694580078125, 960.1727294921875, 960.7017211914062, 960.5366821289062, 959.8675537109375, 960.346435546875, 960.3909912109375, 959.6837768554688, 960.1848754882812, 960.2745361328125, 961.2516479492188, 959.3396606445312, 959.7578125, 960.3153686523438, 961.6102905273438, 959.3609619140625, 959.71875, 960.3622436523438, 961.6392211914062, 959.9512329101562, 960.4137573242188, 961.4615478515625, 960.0245361328125, 960.506591796875, 961.4487915039062, 960.260009765625, 960.392333984375, 961.3545532226562, 962.598388671875, 960.3399658203125, 960.4556274414062, 961.350830078125, 962.7372436523438, 960.296875, 960.7169189453125, 961.5326538085938, 962.4827270507812, 961.0353393554688, 961.8545532226562, 962.6326904296875, 961.1585083007812, 962.3062133789062, 962.7559814453125, 961.2344970703125, 961.94140625, 962.3753662109375, 961.1435546875, 961.7372436523438, 962.177734375, 962.5806884765625, 961.3603515625, 961.9989013671875, 962.3768310546875, 962.3660888671875, 961.298828125, 961.7260131835938, 962.1199340820312, 961.9121704101562, 961.4136352539062, 961.5946655273438, 961.735107421875, 961.0340576171875, 961.5680541992188, 962.097900390625, 960.3020629882812, 960.9302978515625, 961.1039428710938, 959.9144287109375, 960.6051635742188, 961.0863037109375, 961.5204467773438, 960.1030883789062, 960.46826171875, 960.8092041015625, 961.525634765625, 960.0523071289062, 960.3594360351562, 960.66455078125, 961.541259765625, 960.4273071289062, 960.5709838867188, 961.3701171875, 959.8748168945312, 960.2517700195312, 961.3548583984375, 960.191650390625, 960.7703247070312, 961.8349609375, 962.883056640625, 960.2371826171875, 961.008056640625, 961.8682250976562, 962.7141723632812, 960.374755859375, 961.1204223632812, 961.8233032226562, 962.6709594726562, 961.0744018554688, 961.8763427734375, 962.6765747070312, 961.33837890625, 962.1824951171875, 962.5031127929688, 961.4843139648438, 962.38623046875, 962.9452514648438, 961.48583984375, 962.4996337890625, 963.1425170898438, 963.3688354492188, 961.3475952148438, 962.6937866210938, 963.4586181640625, 963.9664916992188, 961.2994384765625, 962.669677734375, 963.9944458007812, 964.51025390625, 962.28515625, 964.0982055664062, 964.6787719726562, 962.151611328125, 963.5771484375, 964.4794311523438, 961.5263061523438, 962.8366088867188, 964.2966918945312, 961.1674194335938, 962.392822265625, 963.7372436523438, 964.431396484375, 961.5215454101562, 962.1325073242188, 962.9502563476562, 963.8278198242188, 961.6865844726562, 962.2159423828125, 962.5326538085938, 963.1783447265625, 961.904052734375, 962.66357421875, 963.1200561523438, 962.0068969726562, 962.5806884765625, 963.1401977539062, 961.9527587890625, 962.5879516601562, 962.8615112304688, 963.2769775390625, 961.7811279296875, 962.3682861328125, 962.6787109375, 963.6903686523438, 961.7874755859375, 961.9527587890625, 962.6725463867188, 962.9537353515625, 961.4935302734375, 962.2255249023438, 962.4006958007812, 960.5914916992188, 960.9522094726562, 961.6118774414062, 959.6575927734375, 960.3634033203125, 961.1431884765625, 958.8681030273438, 959.4976806640625, 960.6666259765625, 961.36083984375, 958.6931762695312, 959.41357421875, 960.4651489257812, 961.1841430664062, 958.6397094726562, 959.5131225585938, 960.3931884765625, 961.1564331054688, 959.7936401367188, 960.84033203125, 961.3990478515625, 960.264404296875, 961.1471557617188, 961.5494995117188, 960.5232543945312, 961.1679077148438, 961.3553466796875, 959.4589233398438, 960.7188720703125, 961.3761596679688, 961.8085327148438, 960.0493774414062, 960.6121826171875, 961.1524047851562, 961.8087158203125, 959.9344482421875, 959.9082641601562, 961.1217651367188, 961.6700439453125, 959.8912963867188, 961.00732421875, 961.1749877929688, 959.76806640625, 960.35205078125, 961.06494140625, 959.810546875, 960.1621704101562, 960.7347412109375, 961.4164428710938, 959.7288818359375, 960.0880126953125, 960.6234741210938, 961.3040161132812, 959.6362915039062, 959.9098510742188, 960.5892333984375, 961.1544189453125, 959.8341064453125, 960.4708862304688, 961.0021362304688, 959.3865356445312, 960.093505859375, 960.5554809570312, 959.064453125, 959.380126953125, 959.988037109375, 958.5527954101562, 958.63330078125, 959.37890625, 960.0224609375, 958.0499267578125, 958.0294189453125, 958.9741821289062, 959.7388305664062, 957.8511352539062, 958.3707275390625, 958.8232421875, 959.2505493164062, 958.1784057617188, 958.523193359375, 958.5021362304688, 957.76025390625, 957.9511108398438, 958.57373046875, 957.2921142578125, 957.529296875, 958.2047119140625, 956.8734130859375, 956.843505859375, 957.9340209960938, 958.472900390625, 956.5443115234375, 956.7704467773438, 957.7943115234375, 958.3390502929688, 955.7611083984375, 956.459228515625, 957.3843994140625, 957.7724609375, 955.959716796875, 956.7796630859375, 957.4774780273438, 955.61181640625, 956.3333129882812, 957.0617065429688, 955.629150390625, 956.1043701171875, 956.5503540039062, 957.1013793945312, 955.635009765625, 956.0403442382812, 956.3931274414062, 956.6006469726562, 955.46240234375, 955.9639282226562, 956.6505737304688, 956.4939575195312, 955.8713989257812, 956.3716430664062, 956.425537109375, 955.3258666992188, 955.862548828125, 956.010986328125, 955.1835327148438, 955.3408813476562, 956.0216064453125, 954.7700805664062, 955.277099609375, 955.8167114257812, 956.3912963867188, 955.0271606445312, 954.9267578125, 955.8667602539062, 956.0984497070312, 955.1154174804688, 955.1854858398438, 955.4217529296875, 955.6893310546875, 955.1744995117188, 955.5564575195312, 955.6516723632812, 955.2554931640625, 955.2845458984375, 955.59326171875, 954.7937622070312, 955.0003662109375, 955.441162109375, 954.714599609375, 954.7730102539062, 955.3627319335938, 955.69189453125, 954.6951904296875, 954.8480224609375, 955.2389526367188, 955.7483520507812, 954.6978149414062, 954.93115234375, 955.2584838867188, 955.7200927734375, 954.949951171875, 955.27978515625, 955.6829223632812, 955.0206909179688, 955.2892456054688, 955.5350341796875, 955.0438842773438, 955.2800903320312, 955.4528198242188, 955.724365234375, 954.9620361328125, 955.3052978515625, 955.356689453125, 955.7102661132812, 954.8838500976562, 955.5341796875, 955.5861206054688, 955.6754150390625, 955.3941650390625, 956.0330200195312, 955.740966796875, 955.2029418945312, 955.6580810546875, 955.8104858398438, 955.040283203125, 955.4498901367188, 955.8178100585938, 954.4951171875]

    surf_example_x_smol = surf_example_x[:50]
    surf_example_y_smol = surf_example_y[:50]

    surf_buffer = 30
    grnd_buffer = 40
    grnd_nodata_value = 0
    surf_nodata_value = 0
    do_plot = False
    print(grnd_example_x, grnd_example_y, 30)
    print(surf_example_x, surf_example_y, 30)
    outer = run(grnd_example_x, grnd_example_y, grnd_buffer, grnd_nodata_value,
                surf_example_x, surf_example_y, surf_buffer, surf_nodata_value,
                do_plot)
    print(outer)